{% extends "index.html" %}



{% block content %}

        <div id="chart"></div>

{% endblock %}



{% block scripts %}

    <script type="text/javascript" src="{{ url_for('static', filename='js/handlebars-v1.3.0.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/gcharts.js') }}"></script>

    <script id="tooltip-template" type="text/x-handlebars-template">
        <div class="tooltip-div">
            <h3>{{ year }}</h3>

            <div class="soften"></div>

            <p>
                <i class="fa fa-male"></i>&emsp;{{ males }} %
            </p>

            <p>
                <i class="fa fa-female"></i>&emsp;{{ females }} %
            </p>
        </div>
    </script>

    <script type="text/javascript">
        google.load("visualization", "1", {packages:["corechart"]});
        google.setOnLoadCallback(drawChart);

        function drawChart() {
            var dataTable = new google.visualization.DataTable();

            dataTable.addColumn('string', 'Year');
            dataTable.addColumn({'type': 'string', 'role': 'tooltip', 'p': {'html': true}});
            dataTable.addColumn('number', 'Female');
            dataTable.addColumn('number', 'Male');

            dataTable.addRows([
                ['1977', generateTooltipHTML(1977, 15.7024793388, 84.2975206612), 15.7024793388, 84.2975206612],
                ['1978', generateTooltipHTML(1978, 19.3619361936, 80.6380638064), 19.3619361936, 80.6380638064],
                ['1979', generateTooltipHTML(1979, 19.740777667, 80.259222333), 19.740777667, 80.259222333],
                ['1980', generateTooltipHTML(1980, 19.8190045249, 80.1809954751), 19.8190045249, 80.1809954751],
                ['1981', generateTooltipHTML(1981, 18.8372093023, 81.1627906977), 18.8372093023, 81.1627906977],
                ['1982', generateTooltipHTML(1982, 20.5821205821, 79.4178794179), 20.5821205821, 79.4178794179],
                ['1983', generateTooltipHTML(1983, 21.3342140026, 78.6657859974), 21.3342140026, 78.6657859974],
                ['1984', generateTooltipHTML(1984, 22.5900681597, 77.4099318403), 22.5900681597, 77.4099318403],
                ['1985', generateTooltipHTML(1985, 24.9114521842, 75.0885478158), 24.9114521842, 75.0885478158],
                ['1986', generateTooltipHTML(1986, 25.0255362615, 74.9744637385), 25.0255362615, 74.9744637385],
                ['1987', generateTooltipHTML(1987, 25.5591054313, 74.4408945687), 25.5591054313, 74.4408945687],
                ['1988', generateTooltipHTML(1988, 27.1760535644, 72.8239464356), 27.1760535644, 72.8239464356],
                ['1989', generateTooltipHTML(1989, 29.0592081366, 70.9407918634), 29.0592081366, 70.9407918634],
                ['1990', generateTooltipHTML(1990, 27.463312369, 72.536687631), 27.463312369, 72.536687631],
                ['1991', generateTooltipHTML(1991, 28.16, 71.84), 28.16, 71.84],
                ['1992', generateTooltipHTML(1992, 29.7724399494, 70.2275600506), 29.7724399494, 70.2275600506],
                ['1993', generateTooltipHTML(1993, 32.1075323358, 67.8924676642), 32.1075323358, 67.8924676642],
                ['1994', generateTooltipHTML(1994, 32.2189202576, 67.7810797424), 32.2189202576, 67.7810797424],
                ['1995', generateTooltipHTML(1995, 32.6422483299, 67.3577516701), 32.6422483299, 67.3577516701],
                ['1996', generateTooltipHTML(1996, 33.3062550772, 66.6937449228), 33.3062550772, 66.6937449228],
                ['1997', generateTooltipHTML(1997, 34.3451066961, 65.6548933039), 34.3451066961, 65.6548933039],
                ['1998', generateTooltipHTML(1998, 34.1696039809, 65.8303960191), 34.1696039809, 65.8303960191],
                ['1999', generateTooltipHTML(1999, 36.9706519598, 63.0293480402), 36.9706519598, 63.0293480402],
                ['2000', generateTooltipHTML(2000, 36.9062784349, 63.0937215651), 36.9062784349, 63.0937215651],
                ['2001', generateTooltipHTML(2001, 38.9734912578, 61.0265087422), 38.9734912578, 61.0265087422],
                ['2002', generateTooltipHTML(2002, 40.6630455141, 59.3369544859), 40.6630455141, 59.3369544859],
                ['2003', generateTooltipHTML(2003, 39.3030009681, 60.6969990319), 39.3030009681, 60.6969990319],
                ['2004', generateTooltipHTML(2004, 42.4561403509, 57.5438596491), 42.4561403509, 57.5438596491],
                ['2005', generateTooltipHTML(2005, 44.4007522653, 55.5992477347), 44.4007522653, 55.5992477347],
                ['2006', generateTooltipHTML(2006, 45.552280215, 54.447719785), 45.552280215, 54.447719785],
                ['2007', generateTooltipHTML(2007, 47.114231889, 52.885768111), 47.114231889, 52.885768111],
                ['2008', generateTooltipHTML(2008, 47.685600718, 52.314399282), 47.685600718, 52.314399282],
                ['2009', generateTooltipHTML(2009, 48.5451595457, 51.4548404543), 48.5451595457, 51.4548404543],
                ['2010', generateTooltipHTML(2010, 47.3644859813, 52.6355140187), 47.3644859813, 52.6355140187],
                ['2011', generateTooltipHTML(2011, 47.9009433962, 52.0990566038), 47.9009433962, 52.0990566038],
                ['2012', generateTooltipHTML(2012, 49.3334814486, 50.6665185514), 49.3334814486, 50.6665185514],
                ['2013', generateTooltipHTML(2013, 48.5741063061, 51.4258936939), 48.5741063061, 51.4258936939],
                ['2014', generateTooltipHTML(2014, 46.9534050179, 53.0465949821), 48.5741063061, 51.4258936939]
            ]);

            var options = {
                title: 'Porcentaje de tesis doctorales aptas en base al género',
                width: 850,
                height: 350,
                hAxis: {
                    title: 'Año',
                },
                yAxis: {
                    title: 'Porcentaje',
                },
                isStacked: true,
                colors: ['#ffa3b1', '#4d6df3'],
                dataOpacity: 0.75,
                // This line makes the entire category's tooltip active.
                focusTarget: 'category',
                // Use an HTML tooltip.
                tooltip: { isHtml: true},
            };

            // function generateTooltipHTML(year, females, males) {
            //     var template_source = $('#tooltip-template').html();
            //     var template = Handlebars.compile(template_source);

            //     var tooltip_data = {
            //         year: year,
            //         females: females.toFixed(2),
            //         males: males.toFixed(2),
            //     }

            //     return template(tooltip_data);
            // };

            function generateTooltipHTML(year, females, males) {
                var html = "\
                    <div class='tooltip-div'> \
                        <h3>" +  year + "</h3> \
                        <div class='soften'></div> \
                        <p> \
                            <i class='fa fa-male'></i>&emsp;" + males.toFixed(2) + " % \
                            <br> \
                            <i class='fa fa-female'></i>&emsp;" + females.toFixed(2) + " % \
                        </p> \
                    </div> \
                ";

                return html;
            };

            var chart = new google.visualization.ColumnChart(document.getElementById('chart')).draw(dataTable, options);
        }
    </script>

{% endblock %}
